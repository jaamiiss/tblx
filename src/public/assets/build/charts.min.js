class BaseChart{constructor(t,e={}){this.chartType=t,this.containerId=e.containerId||this.getDefaultContainerId(),this.chartInstance=null,this.data=null,this.enableLegendToggle=!1!==e.enableLegendToggle,this.enableTooltips=!1!==e.enableTooltips,this.logger=window.logManager?window.logManager.createModuleLogger(`Chart-${t}`):{error:console.error,warn:console.warn,info:console.log,debug:console.log,verbose:console.log},this.logger.info(`${t} Chart: Initialized with container '${this.containerId}'`)}getDefaultContainerId(){const t=this.chartType.toLowerCase();switch(t){case"pie":return"pieChart";case"bar":return"barChart";case"scatter":return"scatterChart";default:return`${t}Chart`}}showSpinner(){this.logger.info(`${this.chartType} Chart: Showing spinner for container '${this.containerId}'`),this.logger.debug(`${this.chartType} Chart: HTMX spinner will be shown automatically`)}hideSpinner(){this.logger.info(`${this.chartType} Chart: Hiding spinner for container '${this.containerId}'`),this.logger.debug(`${this.chartType} Chart: HTMX spinner will be hidden automatically`)}destroyChart(){this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null,this.logger.debug(`${this.chartType} Chart: Destroyed existing chart`))}async fetchData(t){try{this.logger.info(`${this.chartType} Chart: Fetching data from ${t}`);const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const a=await e.json();return this.logger.info(`${this.chartType} Chart: Data fetched successfully`),a}catch(t){throw this.logger.error(`${this.chartType} Chart: Failed to fetch data:`,t),t}}handleError(t,e=null){this.logger.error(`${this.chartType} Chart: Error creating chart:`,t),e?(this.logger.info(`${this.chartType} Chart: Using fallback data`),this.createChart(e)):this.showErrorMessage()}showErrorMessage(){const t=`${this.chartType.toLowerCase()}Chart`,e=document.getElementById(t);if(e){const t=window.ChartConfig?window.ChartConfig.getCommonLabels():{errorIcon:"⚠️",errorMessage:"Failed to load chart"};e.innerHTML=`\n        <div class="chart-error">\n          <div class="error-icon">${t.errorIcon}</div>\n          <div class="error-message">${t.errorMessage} ${this.chartType} chart</div>\n        </div>\n      `}}createCustomLegend(t,e,a,r,o=null){const s=document.getElementById(t);s?(s.innerHTML="",e.forEach((t,e)=>{const o=document.createElement("div");o.className=`legend-item ${this.chartType.toLowerCase()}-legend-item`,o.style.position="relative",o.style.cursor="pointer";const n=document.createElement("div");n.className="legend-color",n.style.backgroundColor=a[e];const i=document.createElement("span");i.className="legend-label",i.textContent=t;const l=document.createElement("div");if(l.className="legend-tooltip",window.ChartColors&&window.ChartColors.applyTooltipStyles)window.ChartColors.applyTooltipStyles(l),l.style.opacity="0",l.style.visibility="hidden",l.style.transition="opacity 0.3s ease, visibility 0.3s ease",l.style.pointerEvents="none",l.style.whiteSpace="nowrap";else{const t=window.ChartColors?window.ChartColors.getTooltipColors():{background:"#ffffff",text:"#000000",border:"#FE0000"};l.style.position="absolute",l.style.backgroundColor=t.background,l.style.color=t.text,l.style.padding="8px 12px",l.style.borderRadius="4px",l.style.fontSize="11px",l.style.fontWeight="600",l.style.border=`1px solid ${t.border}`,l.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.3)",l.style.zIndex="99999",l.style.opacity="0",l.style.visibility="hidden",l.style.transition="opacity 0.3s ease, visibility 0.3s ease",l.style.pointerEvents="none",l.style.whiteSpace="nowrap"}l.innerHTML=this.getTooltipText(t,r,e),this.enableLegendToggle&&(o.style.cursor="pointer",o.addEventListener("click",()=>{this.toggleDataVisibility(t,e)})),this.enableTooltips&&(o.addEventListener("mouseenter",()=>{document.querySelectorAll(".legend-tooltip").forEach(t=>{t.style.opacity="0",t.style.visibility="hidden"}),document.body.contains(l)||document.body.appendChild(l);const t=o.getBoundingClientRect();let e=t.left+t.width/2,a=t.top-50;e-100<10?e=110:e+100>window.innerWidth-10&&(e=window.innerWidth-100-10),a<10&&(a=t.bottom+10),a>window.innerHeight-60&&(a=window.innerHeight-60-10),l.style.setProperty("opacity","1","important"),l.style.setProperty("visibility","visible","important"),l.style.setProperty("display","block","important"),l.style.setProperty("position","fixed","important"),l.style.setProperty("z-index","99999","important");const r=window.ChartColors?window.ChartColors.getTooltipColors():{background:"#ffffff",text:"#000000",border:"#ff0000"};l.style.setProperty("background",r.background,"important"),l.style.setProperty("color",r.text,"important"),l.style.setProperty("border",`2px solid ${r.border}`,"important"),l.style.setProperty("padding","10px","important"),l.style.setProperty("left",`${e}px`,"important"),l.style.setProperty("top",`${a}px`,"important"),l.style.setProperty("transform","translateX(-50%)","important"),setTimeout(()=>{l.getBoundingClientRect()},100)}),o.addEventListener("mouseleave",()=>{l.style.setProperty("opacity","0","important"),l.style.setProperty("visibility","hidden","important"),setTimeout(()=>{document.body.contains(l)&&document.body.removeChild(l)},300)})),this.enableTooltips&&o.addEventListener("mousemove",t=>{const e=o.getBoundingClientRect();let a=e.left+e.width/2,r=e.top-50;a-100<10?a=110:a+100>window.innerWidth-10&&(a=window.innerWidth-100-10),r<10&&(r=e.bottom+10),r>window.innerHeight-60&&(r=window.innerHeight-60-10),l.style.position="fixed",l.style.left=`${a}px`,l.style.top=`${r}px`,l.style.transform="translateX(-50%)",l.style.zIndex="99999"}),o.appendChild(n),o.appendChild(i),s.appendChild(o)}),o&&"Scatter"===this.chartType&&this.addSimilarityStats(s,o),this.logger.debug(`${this.chartType} Chart: Custom legend created`)):this.logger.warn(`${this.chartType} Chart: Legend container ${t} not found`)}toggleDataVisibility(t,e){if(!this.chartInstance)return void this.logger.warn(`${this.chartType} Chart: Chart instance not available for toggle`);const a=this.chartInstance.getDatasetMeta(e);a.hidden=!a.hidden;const r=document.querySelector(`.${this.chartType.toLowerCase()}-legend-item:nth-child(${e+1})`);r&&(a.hidden?(r.style.opacity="0.5",r.style.textDecoration="line-through"):(r.style.opacity="1",r.style.textDecoration="none")),this.chartInstance.update(),this.logger.info(`${this.chartType} Chart: Toggled visibility for ${t}`)}getTooltipText(t,e,a){return`${t}: Data available`}addSimilarityStats(t,e){const a=window.ChartConfig?window.ChartConfig.getCommonLabels():{similarityTitle:"V1 & V2 Similarity",similarValues:"Similar Values",similarity:"Similarity"},r=document.createElement("div");r.className="similarity-section";const o=document.createElement("div");o.className="similarity-title",o.textContent=a.similarityTitle;const s=document.createElement("div");s.className="similarity-content",s.innerHTML=`\n      <div><strong>${a.similarValues}:</strong> ${e.similarCount}/${e.totalCount}</div>\n      <div><strong>${a.similarity}:</strong> ${e.similarityPercentage.toFixed(1)}%</div>\n    `,r.appendChild(o),r.appendChild(s),t.appendChild(r)}toggleLegend(t,e=null){const a=document.getElementById(t);a&&(null===e&&(e="none"===a.style.display),e?a.style.setProperty("display","grid","important"):a.style.setProperty("display","none","important"))}toggleExpand(t){const e=document.getElementById(t);if(!e)return;if(e.classList.contains("expanded"))e.classList.remove("expanded"),document.body.style.overflow="",this.logger.debug(`${this.chartType} Chart: Collapsed`);else{e.classList.add("expanded");const t=window.ChartConfig?window.ChartConfig.getCommonSettings():{expandBackground:"#ffffff"};e.style.backgroundColor=t.expandBackground,document.body.style.overflow="hidden",this.logger.debug(`${this.chartType} Chart: Expanded`)}}}"undefined"!=typeof module&&module.exports?module.exports=BaseChart:window.BaseChart=BaseChart;class PieChart extends BaseChart{constructor(t={}){super("Pie",t),this.data=null}createChart(t){try{this.logger.info("Pie Chart: Creating chart"),this.data=t,this.destroyChart(),this.showSpinner();const e=this.prepareChartData(t);this.chartData=e,this.chartInstance=window.ChartUtils.createPieChart("pieChart",e),this.hideSpinner(),this.createCustomLegend("pieChartLegend",e.labels,e.datasets[0].backgroundColor,t),this.logger.info("Pie Chart: Chart created successfully")}catch(t){this.handleError(t)}}prepareChartData(t){const e=[],a=[],r=[];return Object.entries(t).forEach(([t,o])=>{if("total"!==t&&"number"==typeof o){e.push(t),a.push(o);const s=this.getColorForCategory(t);r.push(s)}}),{labels:e,datasets:[{data:a,backgroundColor:r,borderColor:r.map(t=>t.replace("0.8","1")),borderWidth:1}],colors:r}}getColorForCategory(t){return window.ChartColors?window.ChartColors.getCategoryColor(t):window.ChartColors?.getDefaultColor()||"rgba(201, 203, 207, 0.8)"}async loadData(){try{this.logger.info("Pie Chart: Loading data");const t=await this.fetchData("/stats/chart/pie");this.createChart(t)}catch(t){this.logger.error("Pie Chart: Failed to load data, trying demo data");try{const t=await this.fetchData("/dummy-data/pie");this.createChart(t)}catch(t){this.logger.warn("Pie Chart: Demo data fetch failed, using embedded demo data");const e={Male:105,Female:32,Company:24,Group:30,Unknown:10};this.createChart(e)}}}updateChart(t){this.chartInstance&&t&&(this.logger.info("Pie Chart: Updating chart"),this.createChart(t))}getChartInstance(){return this.chartInstance}getData(){return this.data}toggleDataVisibility(t,e){if(!this.chartInstance)return void this.logger.warn("Pie Chart: Chart instance not available for toggle");const a=this.chartInstance,r=a.getDatasetMeta(0);if(r.data&&r.data[e]){r.data[e].hidden=!r.data[e].hidden;const o=document.querySelector(`.pie-legend-item:nth-child(${e+1})`);if(o){const t=window.ChartConfig?window.ChartConfig.getCommonSettings().visibilityStyles:{hiddenOpacity:"0.5",hiddenTextDecoration:"line-through",visibleOpacity:"1",visibleTextDecoration:"none"};r.data[e].hidden?(o.style.opacity=t.hiddenOpacity,o.style.textDecoration=t.hiddenTextDecoration):(o.style.opacity=t.visibleOpacity,o.style.textDecoration=t.visibleTextDecoration)}a.update(),this.logger.info(`Pie Chart: Toggled visibility for ${t}`)}else this.logger.warn(`Pie Chart: Data point at index ${e} not found`)}getTooltipText(t,e,a){if(e&&"object"==typeof e){const a=e[t]||e[t.toLowerCase()]||0;let r="0";e.total&&e.total>0&&(r=(a/e.total*100).toFixed(1));const o=window.ChartConfig?window.ChartConfig.getLegendTooltipConfigWithOverrides("pieChart"):(()=>{const t=window.ChartColors?.getTooltipColors()||{text:window.ChartColors?.getDefaultColor()||"#000000",border:window.ChartColors?.getDefaultColor()||"#FE0000"};return{statusLabel:window.ChartConfig?.getCommonLabels()?.legendTooltip?.statusLabel||"Category",statusLabelColor:t.border,statusValueColor:t.text}})(),s=o.statusLabelColor||window.ChartColors?.getTooltipColors()?.border||"#FE0000",n=o.statusValueColor||window.ChartColors?.getTooltipColors()?.text||"#000000";return`<strong style="color: ${s};">${o.statusLabel||window.ChartConfig?.getCommonLabels()?.legendTooltip?.statusLabel||"Category"}</strong><br/><strong><span style="color: ${n};">${t}</span></strong><br/>${a} (${r}%)`}const r=window.ChartConfig?window.ChartConfig.getLegendTooltipConfigWithOverrides("pieChart"):(()=>{const t=window.ChartColors?.getTooltipColors()||{text:window.ChartColors?.getDefaultColor()||"#000000",border:window.ChartColors?.getDefaultColor()||"#FE0000"};return{statusLabel:window.ChartConfig?.getCommonLabels()?.legendTooltip?.statusLabel||"Category",statusLabelColor:t.border,statusValueColor:t.text}})(),o=r.statusLabelColor||window.ChartColors?.getTooltipColors()?.border||"#FE0000",s=r.statusValueColor||window.ChartColors?.getTooltipColors()?.text||"#000000",n=window.ChartConfig?.getCommonLabels()?.fallbackText||"Data available";return`<strong style="color: ${o};">${r.statusLabel||window.ChartConfig?.getCommonLabels()?.legendTooltip?.statusLabel||"Category"}</strong><br/><span style="color: ${s};">${t}</span><br/>${n}`}toggleExpand(t){const e=document.getElementById(t);if(!e)return void this.logger.warn("Pie Chart: Container not found for expansion");const a=e.closest(".chart-container");if(!a)return void this.logger.warn("Pie Chart: Chart container not found");a.classList.contains("expanded")?(a.classList.remove("expanded"),this.logger.info("Pie Chart: Chart collapsed")):(a.classList.add("expanded"),this.logger.info("Pie Chart: Chart expanded"),this.chartInstance&&setTimeout(()=>{this.chartInstance.resize()},300))}}"undefined"!=typeof module&&module.exports?module.exports=PieChart:window.PieChart=PieChart;class BarChart extends BaseChart{constructor(t={}){super("Bar",t),this.data=null}async createChart(t){try{this.logger.info("Bar Chart: Creating chart"),this.data=t,this.destroyChart(),this.showSpinner();const e=await this.prepareChartData(t);this.chartData=e,this.chartInstance=window.ChartUtils.createBarChart("barChart",e,this.createCustomOptions()),this.hideSpinner();const a=e.datasets.map(t=>t.label),r=e.datasets.map(t=>t.backgroundColor);this.createCustomLegend("barChartLegend",a,r,t),this.logger.info("Bar Chart: Chart created successfully")}catch(t){this.handleError(t)}}async prepareChartData(t){const e=[],a=[],r=new Set;Object.values(t).forEach(t=>{"object"==typeof t&&Object.keys(t).forEach(t=>{"total"!==t&&r.add(t)})});Array.from(r).forEach((a,r)=>{const o=[],s=[];Object.entries(t).forEach(([t,e])=>{"object"==typeof e&&void 0!==e[a]&&(o.push(e[a]),s.push(t))}),o.length>0&&e.push({label:a.charAt(0).toUpperCase()+a.slice(1),data:o,backgroundColor:this.getColorForStatus(a),borderColor:this.getColorForStatus(a),borderWidth:1})}),a.push(...Object.keys(t).filter(e=>"object"==typeof t[e]));const o=e.map(t=>t.backgroundColor);return{labels:a,datasets:e,colors:o}}createCustomOptions(){return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,...window.ChartConfig?window.ChartConfig.getTooltipConfigWithOverrides("barChart"):(()=>{const t=window.ChartColors?window.ChartColors.getTooltipColors():{background:window.ChartColors?.getDefaultColor()||"#ffffff",text:window.ChartColors?.getDefaultColor()||"#000000",border:window.ChartColors?.getDefaultColor()||"#FE0000"};return{backgroundColor:t.background,titleColor:t.text,bodyColor:t.text,borderColor:t.border,borderWidth:1,padding:5,titleSpacing:4,bodySpacing:3,cornerRadius:6,displayColors:!0}})(),callbacks:{title:function(t){return`${window.ChartConfig?window.ChartConfig.getTooltipTitleText("barChart"):window.ChartConfig?.getChartLabels("barChart")?.tooltipTitle||"Rows"} ${t[0].label}`},label:function(t){return` ${t.dataset.label}: ${t.parsed.y}`},labelColor:function(t){return{borderColor:t.dataset.borderColor||t.dataset.backgroundColor,backgroundColor:t.dataset.backgroundColor,borderWidth:0,borderRadius:6,width:12,height:12}}}}},scales:window.ChartConfig?window.ChartConfig.getAxisConfig("barChart"):(()=>{const t=window.ChartConfig?window.ChartConfig.getFallbackAxisLabels("barChart"):{xAxis:window.ChartConfig?.getChartLabels("barChart")?.xAxis||"Ranges",yAxis:window.ChartConfig?.getChartLabels("barChart")?.yAxis||"Count"};return{x:{display:!0,title:{display:!0,text:t.xAxis}},y:{display:!0,title:{display:!0,text:t.yAxis},beginAtZero:!0}}})(),interaction:{mode:"index",intersect:!1}}}getTooltipText(t,e,a){if(e&&"object"==typeof e){let a=0,r=0;Object.values(e).forEach(e=>{"object"==typeof e&&Object.entries(e).forEach(([e,o])=>{"number"==typeof o&&(r+=o,e.toLowerCase()===t.toLowerCase()&&(a+=o))})});const o=r>0?(a/r*100).toFixed(1):"0.0";if(a>0){const e=window.ChartConfig?window.ChartConfig.getLegendTooltipConfigWithOverrides("barChart"):{statusLabel:"Status",statusLabelColor:"#FE0000",statusValueColor:"#000000"},r=e.statusLabelColor||window.ChartColors?.getTooltipColors()?.border||"#FE0000",s=e.statusValueColor||window.ChartColors?.getTooltipColors()?.text||"#000000";return`<strong style="color: ${r};">${e.statusLabel||"Status"}</strong><br/><strong style="color: ${s};">${t}</strong><br/>${a} (${o}%)`}}return window.ChartConfig?.getCommonLabels()?.fallbackText||"Data available"}getColorForStatus(t){return window.ChartColors?window.ChartColors.getStatusColor(t):window.ChartColors?.getDefaultColor()||"rgba(201, 203, 207, 0.8)"}async loadData(){try{this.logger.info("Bar Chart: Loading data");const t=await this.fetchData("/stats/chart/bar");await this.createChart(t)}catch(t){this.logger.error("Bar Chart: Failed to load data, trying demo data");try{const t=await this.fetchData("/dummy-data/bar");await this.createChart(t)}catch(t){this.logger.warn("Bar Chart: Demo data fetch failed, using embedded demo data");const e={"0-50":{deceased:10,active:10,incarcerated:10,redacted:10,unknown:5,captured:5,total:50},"51-100":{deceased:10,active:10,incarcerated:10,redacted:10,unknown:5,captured:5,total:50},"101-150":{deceased:10,active:10,incarcerated:10,redacted:10,unknown:5,captured:6,total:51},"151-200":{deceased:10,active:10,incarcerated:10,redacted:10,unknown:5,captured:6,total:51}};await this.createChart(e)}}}async updateChart(t){this.chartInstance&&t&&(this.logger.info("Bar Chart: Updating chart"),await this.createChart(t))}getChartInstance(){return this.chartInstance}getData(){return this.data}toggleExpand(t){const e=document.getElementById(t);if(!e)return void this.logger.warn("Bar Chart: Container not found for expansion");const a=e.closest(".chart-container");if(!a)return void this.logger.warn("Bar Chart: Chart container not found");a.classList.contains("expanded")?(a.classList.remove("expanded"),this.logger.info("Bar Chart: Chart collapsed")):(a.classList.add("expanded"),this.logger.info("Bar Chart: Chart expanded"),this.chartInstance&&setTimeout(()=>{this.chartInstance.resize()},300))}}"undefined"!=typeof module&&module.exports?module.exports=BarChart:window.BarChart=BarChart;class ScatterChart extends BaseChart{constructor(t={}){super("Scatter",t),this.data=null,this.dataFilter="both",this.statusFilter="all"}createChart(t){try{this.logger.info("Scatter Chart: Creating chart"),this.data=t,"undefined"==typeof ChartZoom?this.logger.warn("Scatter Chart: Zoom plugin not available, creating chart without zoom functionality"):this.logger.debug("Scatter Chart: Zoom plugin available"),this.destroyChart(),this.showSpinner();const e=this.prepareChartData(t);this.chartData=e;const a=this.createCustomOptions();if(a.plugins?.tooltip?.callbacks){a.plugins.tooltip.callbacks}this.chartInstance=window.ChartUtils.createScatterChart("scatterChart",e,a),this.chartInstance?(this.logger.debug("Scatter Chart: Chart created successfully"),this.chartInstance.zoom?this.logger.debug("Scatter Chart: Zoom functionality available"):this.logger.warn("Scatter Chart: Zoom functionality not available on chart instance")):this.logger.error("Scatter Chart: Failed to create chart"),this.hideSpinner();const r=this.calculateSimilarityStats(t);this.createCustomLegend("scatterChartLegend",e.labels,e.colors,t,r),this.logger.info("Scatter Chart: Chart created successfully")}catch(t){this.handleError(t)}}prepareChartData(t){const e=[],a=(window.ChartColors?window.ChartColors.getStatusColors():window.ChartColors?.getDefaultColor(),[]);let r=[];if(t.items&&Array.isArray(t.items))r=t.items;else if(Array.isArray(t))r=t;else if("object"==typeof t)return Object.entries(t).forEach(([t,r],o)=>{if(Array.isArray(r)&&r.length>0){const o=this.filterItems(r);if(o.length>0){const r={label:t,data:o.map(t=>({x:t.v1,y:t.v2,name:t.name,status:t.status,category:t.category})),backgroundColor:this.getColorForCategory(t),borderColor:this.getColorForCategory(t),pointRadius:6,pointHoverRadius:8};e.push(r),a.push(t)}}}),{datasets:e,labels:a,colors:e.map(t=>t.backgroundColor)};if(r.length>0){const t=this.filterItems(r),o={};t.forEach(t=>{const e=t.status||window.ChartConfig?.getCommonLabels()?.fallbackStatus||"unknown";o[e]||(o[e]=[]),o[e].push(t)}),Object.entries(o).forEach(([t,r],o)=>{if(r.length>0){const o={label:t.charAt(0).toUpperCase()+t.slice(1),data:r.map(t=>({x:t.v1,y:t.v2,name:t.name,status:t.status,category:t.category})),backgroundColor:this.getColorForStatus(t),borderColor:this.getColorForStatus(t),pointRadius:6,pointHoverRadius:8};e.push(o),a.push(t.charAt(0).toUpperCase()+t.slice(1))}})}return{labels:a,datasets:e,colors:e.map(t=>t.backgroundColor)}}getColorForCategory(t){return window.ChartColors?window.ChartColors.getCategoryColor(t):window.ChartColors?.getDefaultColor()||"rgba(201, 203, 207, 0.8)"}getColorForStatus(t){return window.ChartColors?window.ChartColors.getStatusColor(t):window.ChartColors?.getDefaultColor()||"rgba(201, 203, 207, 0.8)"}filterItems(t){return t.filter(t=>("all"===this.statusFilter||t.status===this.statusFilter)&&(("v1"!==this.dataFilter||0!==t.v1)&&("v2"!==this.dataFilter||0!==t.v2)))}createCustomOptions(){return{responsive:!0,maintainAspectRatio:!1,plugins:{...{legend:{display:!1},tooltip:window.ChartConfig?window.ChartConfig.getTooltipConfigWithOverrides("scatterChart"):{backgroundColor:"#ffffff",titleColor:"#000000",bodyColor:"#000000",borderColor:"#FE0000",borderWidth:1,cornerRadius:8,padding:18,displayColors:!0,titleFont:{size:14,weight:"bold",family:"'TBL-2', monospace"},bodyFont:{size:12,family:"'TBL-2', monospace"},callbacks:{title:function(t){if(window.scatterChartMultipleLabels=null,window.scatterChartMultiplePoints=t.length>1,window.scatterChartAllPoints=t,t.length>1){return`${t.length} Data Points`}return t[0].raw.name||window.ChartConfig?.getCommonLabels()?.fallbackName||"Unknown"},label:function(t){if(window.scatterChartMultiplePoints&&window.scatterChartAllPoints){const e=t.raw;e.status&&(e.status.charAt(0).toUpperCase(),e.status.slice(1));return[` ${e.name||"Unknown"}`,` (${e.x}, ${e.y})`]}{const e=t.raw,a=e.status?e.status.charAt(0).toUpperCase()+e.status.slice(1):"Unknown",r=[];return e.category&&"undefined"!==e.category&&r.push(` ${e.category}`),r.push(` ${a}`),r.push(` (${e.x}, ${e.y})`),r}},labelColor:function(t){return{borderColor:t.dataset.borderColor||t.dataset.backgroundColor,backgroundColor:t.dataset.backgroundColor,borderWidth:0,borderRadius:6,width:12,height:12}}}}},zoom:{zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"xy",drag:{enabled:!0,modifierKey:"ctrl",threshold:4}},pan:{enabled:!0,modifierKey:"shift",threshold:4,onPan:function({chart:t}){}},limits:{x:{min:0,max:222},y:{min:0,max:222}},onZoom:function({chart:t}){t.resize()}}},scales:window.ChartConfig?window.ChartConfig.getAxisConfig("scatterChart"):{x:{title:{display:!0},min:0,max:222},y:{title:{display:!0},min:0,max:222}},interaction:{intersect:!0,mode:"point"},onHover:(t,e)=>{t.native.target.style.cursor=e.length>0?"pointer":"default"}}}calculateSimilarityStats(t){let e=[];t.items&&Array.isArray(t.items)?e=t.items:Array.isArray(t)?e=t:"object"==typeof t&&(e=[],Object.values(t).forEach(t=>{Array.isArray(t)&&(e=e.concat(t))}));const a=this.filterItems(e);let r=0;a.forEach(t=>{t.v1===t.v2&&r++});const o=a.length;return{similarCount:r,totalCount:o,similarityPercentage:o>0?r/o*100:0}}async loadData(){try{this.logger.info("Scatter Chart: Loading data");const t=await this.fetchData("/stats/chart/scatter");this.createChart(t)}catch(t){this.logger.error("Scatter Chart: Failed to load data, trying demo data");try{const t=await this.fetchData("/dummy-data/scatter");this.createChart(t)}catch(t){this.logger.warn("Scatter Chart: Demo data fetch failed, using embedded demo data");const e={items:[{v1:1,v2:101,name:"John Smith",status:"deceased",category:"Unknown"},{v1:2,v2:102,name:"Sarah Johnson",status:"active",category:"Unknown"},{v1:3,v2:103,name:"TechCorp Inc.",status:"incarcerated",category:"Unknown"},{v1:4,v2:104,name:"Alpha Group",status:"redacted",category:"Unknown"},{v1:5,v2:105,name:"Unknown Entity",status:"unknown",category:"Unknown"},{v1:6,v2:106,name:"Robert Wilson",status:"deceased",category:"Unknown"},{v1:7,v2:107,name:"Jennifer Garcia",status:"active",category:"Unknown"},{v1:8,v2:108,name:"DataFlow Systems",status:"incarcerated",category:"Unknown"},{v1:9,v2:109,name:"Beta Organization",status:"redacted",category:"Unknown"},{v1:10,v2:110,name:"Mystery Person",status:"unknown",category:"Unknown"}]};this.createChart(e)}}}updateChart(t){this.chartInstance&&t&&(this.logger.info("Scatter Chart: Updating chart"),this.createChart(t))}setDataFilter(t){this.dataFilter=t,this.data&&this.createChart(this.data)}setStatusFilter(t){this.statusFilter=t,this.data&&this.createChart(this.data)}resetZoom(){this.chartInstance&&this.chartInstance.resetZoom&&(this.chartInstance.resetZoom(),this.logger.debug("Scatter Chart: Zoom reset"))}zoomIn(){if(this.chartInstance)try{if("undefined"!=typeof ChartZoom&&this.chartInstance.zoom&&this.chartInstance.options){const t=this.chartInstance.zoom||1;this.chartInstance.zoom(1.2*t),this.logger.debug("Scatter Chart: Zoomed in")}else this.logger.warn("Scatter Chart: Zoom plugin not available or chart options undefined")}catch(t){this.logger.warn("Scatter Chart: Error zooming in:",t.message)}else this.logger.warn("Scatter Chart: Chart instance not available")}zoomOut(){if(this.chartInstance)try{if("undefined"!=typeof ChartZoom&&this.chartInstance.zoom&&this.chartInstance.options){const t=this.chartInstance.zoom||1;this.chartInstance.zoom(.8*t),this.logger.debug("Scatter Chart: Zoomed out")}else this.logger.warn("Scatter Chart: Zoom plugin not available or chart options undefined")}catch(t){this.logger.warn("Scatter Chart: Error zooming out:",t.message)}else this.logger.warn("Scatter Chart: Chart instance not available")}getChartInstance(){return this.chartInstance}getData(){return this.data}getTooltipText(t,e,a){if(e&&"object"==typeof e){let a=[];if(e.items&&Array.isArray(e.items)?a=e.items.filter(e=>e.status===t.toLowerCase()):Array.isArray(e)&&(a=e.filter(e=>e.status===t.toLowerCase())),a.length>0){const r=a.length,o=e.items?e.items.length:e.length,s=o>0?(r/o*100).toFixed(1):"0.0";let n=0,i=0;if(a.length>0){const t=a.map(t=>t.v1&&t.v2?Math.abs(t.v1-t.v2):0).filter(t=>t>0);t.length>0&&(n=t.reduce((t,e)=>t+e,0)/t.length,i=Math.max(...t))}const l=window.ChartConfig?window.ChartConfig.getLegendTooltipConfigWithOverrides("scatterChart"):{statusLabel:"Status",statusLabelColor:"#FE0000",statusValueColor:"#000000"},h=l.statusLabelColor||window.ChartColors?.getTooltipColors()?.border||"#FE0000",c=l.statusValueColor||window.ChartColors?.getTooltipColors()?.text||"#000000";return`<strong style="color: ${h};">${l.statusLabel||"Status"}</strong><br/><strong style="color: ${c};">${t}</strong><br/>${r} items (${s}%)`}}const r=window.ChartConfig?window.ChartConfig.getLegendTooltipConfigWithOverrides("scatterChart"):{statusLabel:"Status",statusLabelColor:"#FE0000",statusValueColor:"#000000"},o=r.statusLabelColor||window.ChartColors?.getTooltipColors()?.border||"#FE0000",s=r.statusValueColor||window.ChartColors?.getTooltipColors()?.text||"#000000",n=window.ChartConfig?.getCommonLabels()?.fallbackText||"Data available";return`<strong style="color: ${o};">${r.statusLabel||"Status"}</strong><br/><strong style="color: ${s};">${t}</strong><br/>${n}`}toggleExpand(t){const e=document.getElementById(t);if(!e)return void this.logger.warn("Scatter Chart: Container not found for expansion");const a=e.closest(".chart-container");if(!a)return void this.logger.warn("Scatter Chart: Chart container not found");a.classList.contains("expanded")?(a.classList.remove("expanded"),this.logger.info("Scatter Chart: Chart collapsed")):(a.classList.add("expanded"),this.logger.info("Scatter Chart: Chart expanded"),this.chartInstance&&setTimeout(()=>{this.chartInstance.resize()},300))}}"undefined"!=typeof module&&module.exports?module.exports=ScatterChart:window.ScatterChart=ScatterChart;class StatsPageChartsManager{constructor(){this.pieChart=null,this.barChart=null,this.scatterChart=null,this.isLoadingCharts=!1,this.isLoadingDemoData=!1,this.chartsLoaded=!1,this.logger=window.logManager?window.logManager.createModuleLogger("StatsPageChartsManager"):{error:console.error,warn:console.warn,info:console.log,debug:console.log,verbose:console.log},"undefined"!=typeof Chart&&Chart.register&&Chart.register(ChartZoom),this.init()}init(){this.logger.info("Stats Page Charts Manager: Initializing..."),"undefined"!=typeof Chart?(this.logger.info("Stats Page Charts Manager: Chart.js is available, loading charts..."),setTimeout(()=>{this.chartsLoaded?this.logger.debug("Stats Page Charts Manager: Charts already loaded, skipping"):this.loadCharts()},1e3)):(this.logger.info("Stats Page Charts Manager: Chart.js not available, waiting..."),this.waitForChartJS()),this.setupEventListeners()}waitForChartJS(){let t=0;const e=setInterval(()=>{t++,"undefined"!=typeof Chart?(this.logger.info("Stats Page Charts Manager: Chart.js loaded after",100*t,"ms"),clearInterval(e),setTimeout(()=>{this.chartsLoaded?this.logger.debug("Stats Page Charts Manager: Charts already loaded, skipping"):this.loadCharts()},3e3)):t>=50&&(this.logger.error("Stats Page Charts Manager: Chart.js failed to load after 5 seconds"),clearInterval(e),this.loadDemoDataAsFallback())},100)}setupEventListeners(){document.addEventListener("click",t=>{if(t.target.matches(".legend-toggle")){const e=t.target.dataset.legend;this.toggleLegend(e)}else if(t.target.matches(".expand-toggle")){const e=t.target.dataset.chart;this.toggleExpand(e)}else t.target.matches(".zoom-reset")?this.resetScatterZoom():t.target.matches(".zoom-in")?this.zoomInScatter():t.target.matches(".zoom-out")&&this.zoomOutScatter()})}async loadCharts(t=0){if(this.isLoadingCharts)this.logger.debug("Stats Page Charts Manager: Charts already loading, skipping");else{this.isLoadingCharts=!0;try{if(this.logger.info("Stats Page Charts Manager: Loading all charts..."),!window.PieChart||!window.BarChart||!window.ScatterChart)throw new Error("Chart classes not loaded yet");this.pieChart||(this.pieChart=new PieChart({enableLegendToggle:!0,enableTooltips:!0})),this.barChart||(this.barChart=new BarChart({enableLegendToggle:!0,enableTooltips:!0})),this.scatterChart||(this.scatterChart=new ScatterChart({enableLegendToggle:!0,enableTooltips:!0})),this.logger.info("Stats Page Charts Manager: Loading pie chart..."),await this.pieChart.loadData(),await this.delay(500),this.logger.info("Stats Page Charts Manager: Loading bar chart..."),await this.barChart.loadData(),await this.delay(500),this.logger.info("Stats Page Charts Manager: Loading scatter chart..."),await this.scatterChart.loadData(),this.logger.info("Stats Page Charts Manager: All charts loaded progressively"),this.chartsLoaded=!0,this.triggerButtonInitialization()}catch(e){this.logger.error("Stats Page Charts Manager: Error loading charts:",e),t<2?(this.logger.info(`Stats Page Charts Manager: Retrying in 2 seconds (attempt ${t+1}/2)`),this.isLoadingCharts=!1,setTimeout(()=>{this.loadCharts(t+1)},2e3)):(this.logger.error("Stats Page Charts Manager: Max retries reached, loading demo data"),await this.loadDemoDataAsFallback())}finally{t>=2&&(this.isLoadingCharts=!1)}}}delay(t){return new Promise(e=>setTimeout(e,t))}triggerButtonInitialization(){this.logger.info("Stats Page Charts Manager: Triggering button initialization..."),window.dispatchEvent(new CustomEvent("chartsReady",{detail:{statsPageCharts:this,pieChart:this.pieChart,barChart:this.barChart,scatterChart:this.scatterChart}})),window.chartButtonsManager?(this.logger.info("Stats Page Charts Manager: Direct button initialization"),window.chartButtonsManager.initializeButtons(this)):this.logger.warn("Stats Page Charts Manager: chartButtonsManager not available for direct initialization")}async loadDemoDataAsFallback(){if(this.isLoadingDemoData)this.logger.debug("Stats Page Charts Manager: Demo data already loading, skipping");else{this.isLoadingDemoData=!0;try{this.logger.info("Stats Page Charts Manager: Loading demo data as fallback"),this.pieChart||(this.pieChart=new PieChart({enableLegendToggle:!0,enableTooltips:!0})),this.barChart||(this.barChart=new BarChart({enableLegendToggle:!0,enableTooltips:!0})),this.scatterChart||(this.scatterChart=new ScatterChart({enableLegendToggle:!0,enableTooltips:!0}));const t=await this.fetchDemoData();this.pieChart.createChart(t.pie),await this.barChart.createChart(t.bar),this.scatterChart.createChart(t.scatter),this.logger.info("Stats Page Charts Manager: Demo data loaded successfully")}catch(t){this.logger.error("Stats Page Charts Manager: Failed to load demo data:",t)}finally{this.isLoadingDemoData=!1}}}async fetchDemoData(){const t=await fetch("/dummy-data/stats");if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return await t.json()}toggleLegend(t){this.pieChart&&"pieChartLegend"===t?this.pieChart.toggleLegend(t):this.barChart&&"barChartLegend"===t?this.barChart.toggleLegend(t):this.scatterChart&&"scatterChartLegend"===t&&this.scatterChart.toggleLegend(t)}closeModal(){const t=document.getElementById("chartModal"),e=document.getElementById("modalChartContainer");if(t){if(e){const t=e.querySelector("canvas");if(t){const e=Chart.getChart(t);e&&(e.destroy(),this.logger.info("Modal chart instance destroyed"))}e.innerHTML=""}t.classList.remove("active"),document.body.classList.remove("chart-modal-open"),document.body.style.overflow="",this.logger.info("Chart modal closed and cleaned up")}}createChartControls(t,e=!1){const a={legendToggle:()=>this.toggleLegend(`${t}Legend`),refresh:()=>{e?this.refreshScatterChart():this.refreshChart(t)},expand:()=>this.toggleExpand(t),zoomIn:()=>this.zoomInScatter(),zoomOut:()=>this.zoomOutScatter()};let r;return r=e?window.ChartButtonIcons.createScatterControls(a):window.ChartButtonIcons.createStandardControls(a),r}createModalChartControls(t,e=!1){const a={legendToggle:()=>this.toggleLegend(`${t}LegendModal`),refresh:()=>{e?this.refreshScatterChart():this.refreshModalChart(t)},close:()=>this.closeModal(),zoomIn:()=>this.zoomInScatter(),zoomOut:()=>this.zoomOutScatter()};return e?window.ChartButtonIcons.createModalScatterControls(a):window.ChartButtonIcons.createModalControls(a)}refreshChart(t){document.getElementById(`${t}Wrapper`)?(htmx.trigger(document.body,`refresh-${t}`),this.logger.info(`StatsPageChartsManager: Triggered HTMX refresh for ${t}`)):this.logger.warn(`Chart wrapper not found for ${t}`)}refreshModalChart(t){const e=document.querySelector("#modalChartContainer .refresh-button");e&&window.ChartButtonIcons.addLoadingState(e),setTimeout(()=>{const a=document.getElementById("modalChartContainer");if(a){const e=this[t.toLowerCase()];e&&e.chart&&(a.innerHTML="",this.createModalChartStructure(a,t),setTimeout(()=>{const r=a.querySelector(".chart-canvas-container"),o=a.querySelector(".chart-legend");if(r&&o){const a=document.createElement("canvas");a.id=`${t}Modal`,r.appendChild(a);new Chart(a,e.chart.config).resize(),this.recreateModalLegend(o,t)}},100))}e&&window.ChartButtonIcons.removeLoadingState(e)},500)}recreateModalLegend(t,e){const a=this[e.toLowerCase()]?.chartData;a&&a.labels&&a.colors&&(t.innerHTML="",a.labels.forEach((e,r)=>{const o=document.createElement("div");o.className="legend-item",o.style.display="flex",o.style.alignItems="center",o.style.gap="6px",o.style.margin="2px",o.style.padding="4px 8px",o.style.borderRadius="4px",o.style.cursor="pointer";const s=document.createElement("div");s.className="legend-color",s.style.backgroundColor=a.colors[r],s.style.width="12px",s.style.height="12px",s.style.borderRadius="2px",s.style.border="none";const n=document.createElement("span");n.className="legend-label",n.textContent=e,n.style.fontSize="0.8rem",n.style.fontWeight="bold",n.style.textTransform="uppercase",o.appendChild(s),o.appendChild(n),t.appendChild(o)}))}zoomInScatter(){this.scatterChart&&this.scatterChart.zoomIn()}zoomOutScatter(){this.scatterChart&&this.scatterChart.zoomOut()}toggleExpand(t){const e=document.getElementById("chartModal"),a=document.getElementById("modalChartContainer");if(!e||!a)return void this.logger.warn("Chart modal elements not found");let r,o;if("pieChart"===t&&this.pieChart?(r=document.getElementById("pieChart"),o=this.pieChart.chartInstance):"barChart"===t&&this.barChart?(r=document.getElementById("barChart"),o=this.barChart.chartInstance):"scatterChart"===t&&this.scatterChart&&(r=document.getElementById("scatterChart"),o=this.scatterChart.chartInstance),!r||!o)return void this.logger.warn(`Chart ${t} not found or not initialized`);a.innerHTML="";const s=document.createElement("div");s.className="chart-modal-header";const n=document.createElement("h3");n.textContent=this.getChartTitle(t),s.appendChild(n);const i=document.createElement("div");i.className="chart-controls";const l="scatterChart"===t,h=this.createModalChartControls(t,l);window.ChartButtonIcons.addButtonsToContainer(i,h),s.appendChild(i);const c=document.createElement("div");c.className="chart-wrapper";const d=document.createElement("div");d.className="chart-canvas-container",d.style.width="100%",d.style.height="400px";const g=document.createElement("div");g.className="chart-legend",g.id=`${t}LegendModal`,c.appendChild(d),c.appendChild(g),a.appendChild(s),a.appendChild(c),e.classList.add("active"),document.body.style.overflow="hidden",setTimeout(()=>{if(o){const e=document.createElement("canvas");e.id=`${t}Modal`,d.appendChild(e);const a={...o.config};a.options&&a.options.plugins&&(a.options.plugins.legend={display:!0,position:"bottom",labels:{usePointStyle:!0,padding:20,font:{size:12,family:"'Blacklisted', 'Arial Black', Arial, Helvetica, sans-serif"}}});if(new Chart(e,a).resize(),g&&this[t.toLowerCase()]){const e=this[t.toLowerCase()].chartData;e&&e.labels&&e.colors&&(g.innerHTML="",e.labels.forEach((t,a)=>{const r=document.createElement("div");r.className="legend-item",r.style.display="flex",r.style.alignItems="center",r.style.gap="6px",r.style.margin="2px",r.style.padding="4px 8px",r.style.borderRadius="4px",r.style.cursor="pointer",r.style.transition="background-color 0.2s",r.style.whiteSpace="nowrap",r.style.flexShrink="0";const o=document.createElement("div");o.className="legend-color",o.style.width="12px",o.style.height="12px",o.style.backgroundColor=e.colors[a],o.style.borderRadius="2px",o.style.border="none",o.style.flexShrink="0";const s=document.createElement("span");if(s.className="legend-label",s.textContent=t,s.style.fontSize="0.8rem",s.style.fontWeight="bold",s.style.textTransform="uppercase",s.style.flexShrink="0",e.counts&&void 0!==e.counts[a]){const t=document.createElement("span");t.className="legend-value",t.textContent=e.counts[a],t.style.fontSize="0.75rem",t.style.color="#666",t.style.flexShrink="0",r.appendChild(t)}r.appendChild(o),r.appendChild(s),g.appendChild(r)}),this.logger.info(`Legend recreated for ${t} in modal`))}this.logger.info(`Chart ${t} created in modal with full functionality`)}},100),this.logger.info(`Chart ${t} opened in modal`)}ensureModalChartStructure(t,e){let a=t.querySelector(".chart-modal-header");if(!a){a=document.createElement("div"),a.className="chart-modal-header";const r=document.createElement("h3");r.textContent=this.getChartTitle(e),a.appendChild(r);const o=document.createElement("div");o.className="chart-controls";const s="scatterChart"===e,n=this.createModalChartControls(e,s);window.ChartButtonIcons.addButtonsToContainer(o,n),a.appendChild(o),t.insertBefore(a,t.firstChild)}let r=t.querySelector(".chart-wrapper");if(!r){r=document.createElement("div"),r.className="chart-wrapper";const a=document.createElement("div");a.className="chart-canvas-container",a.style.width="100%",a.style.height="400px";const o=document.createElement("div");o.className="chart-legend",o.id=`${e}LegendModal`,r.appendChild(a),r.appendChild(o),t.appendChild(r)}}getChartTitle(t){return{pieChart:"Category Distribution",barChart:"Status Distribution",scatterChart:"V1 vs V2 Analysis"}[t]||"Chart"}addScatterChartControls(t){const e=t.querySelector(".chart-controls");if(!e)return;if(e.querySelector(".zoom-in")||e.querySelector(".refresh-button"))return;const a=document.createElement("button");a.className="zoom-in",a.title="Zoom In",a.innerHTML='\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n        <circle cx="11" cy="11" r="8"></circle>\n        <path d="M21 21l-4.35-4.35"></path>\n        <line x1="11" y1="8" x2="11" y2="14"></line>\n        <line x1="8" y1="11" x2="14" y2="11"></line>\n      </svg>\n    ';const r=document.createElement("button");r.className="zoom-out",r.title="Zoom Out",r.innerHTML='\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n        <circle cx="11" cy="11" r="8"></circle>\n        <path d="M21 21l-4.35-4.35"></path>\n        <line x1="8" y1="11" x2="14" y2="11"></line>\n      </svg>\n    ';const o=document.createElement("button");o.className="refresh-button",o.title="Refresh Chart",o.innerHTML='\n      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>\n        <path d="M21 3v5h-5"></path>\n        <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>\n        <path d="M3 21v-5h5"></path>\n      </svg>\n    ',e.appendChild(a),e.appendChild(r),e.appendChild(o)}setupModalButtons(t,e){t.querySelectorAll(".legend-toggle").forEach(t=>{t.onclick=()=>{const t=`${e}Legend`;this.toggleLegend(t)}});if(t.querySelectorAll(".expand-toggle").forEach(t=>{t.onclick=()=>{this.closeModal()}}),"scatterChart"===e){const e=t.querySelector(".zoom-in");e&&(e.onclick=()=>this.zoomInScatter());const a=t.querySelector(".zoom-out");a&&(a.onclick=()=>this.zoomOutScatter());const r=t.querySelector(".refresh-button");r&&(r.onclick=()=>this.refreshScatterChart())}if("pieChart"===e){const e=t.querySelector(".refresh-button");e&&(e.onclick=()=>this.refreshPieChart())}if("barChart"===e){const e=t.querySelector(".refresh-button");e&&(e.onclick=()=>this.refreshBarChart())}this.logger.info(`Modal buttons setup complete for ${e}`)}refreshScatterChart(){this.logger.info("StatsPageChartsManager: Refreshing scatter chart");const t=document.getElementById("dataFilter"),e=document.getElementById("statusFilter");t&&(t.value="all",this.scatterChart&&(this.scatterChart.dataFilter="all")),e&&(e.value="all",this.scatterChart&&(this.scatterChart.statusFilter="all")),this.resetScatterLegendToggles(),this.resetScatterZoom(),this.refreshChart("scatterChart")}refreshPieChart(){this.logger.info("StatsPageChartsManager: Refreshing pie chart"),this.refreshChart("pieChart")}refreshBarChart(){this.logger.info("StatsPageChartsManager: Refreshing bar chart"),this.refreshChart("barChart")}resetScatterLegendToggles(){if(this.scatterChart&&this.scatterChart.chartInstance)try{const t=this.scatterChart.chartInstance;t.data.datasets.forEach((e,a)=>{t.getDatasetMeta(a).hidden=!1});document.querySelectorAll(".scatter-legend-item").forEach(t=>{t.style.opacity="1",t.style.textDecoration="none"}),t.update("none"),this.logger.info("StatsPageChartsManager: Reset scatter chart legend toggles")}catch(t){this.logger.warn("StatsPageChartsManager: Error resetting scatter legend toggles:",t.message)}}resetScatterZoom(){if(this.scatterChart&&this.scatterChart.chartInstance)try{this.scatterChart.resetZoom()}catch(t){this.logger.warn("StatsPageChartsManager: Error resetting scatter chart zoom:",t)}}zoomInScatter(){if(this.scatterChart&&this.scatterChart.chartInstance)try{this.scatterChart.zoomIn()}catch(t){this.logger.warn("StatsPageChartsManager: Error zooming in scatter chart:",t)}}zoomOutScatter(){if(this.scatterChart&&this.scatterChart.chartInstance)try{this.scatterChart.zoomOut()}catch(t){this.logger.warn("StatsPageChartsManager: Error zooming out scatter chart:",t)}}updateCharts(t){this.pieChart&&t.pie&&this.pieChart.updateChart(t.pie),this.barChart&&t.bar&&this.barChart.updateChart(t.bar),this.scatterChart&&t.scatter&&this.scatterChart.updateChart(t.scatter)}getChartInstances(){return{pie:this.pieChart?.getChartInstance(),bar:this.barChart?.getChartInstance(),scatter:this.scatterChart?.getChartInstance()}}destroyCharts(){this.pieChart&&this.pieChart.destroyChart(),this.barChart&&this.barChart.destroyChart(),this.scatterChart&&this.scatterChart.destroyChart()}}"undefined"!=typeof module&&module.exports?module.exports=StatsPageChartsManager:(window.StatsPageChartsManager=StatsPageChartsManager,document.addEventListener("DOMContentLoaded",()=>{window.statsPageCharts||(window.statsPageCharts=new StatsPageChartsManager)}));class ChartButtonsManager{constructor(){this.initialized=!1,this.chartControls=new Map}initializeButtons(t){if(!this.initialized&&window.ChartButtonIcons&&t)try{this.initializePieChartButtons(t),this.initializeBarChartButtons(t),this.initializeScatterChartButtons(t),this.initialized=!0}catch(t){}}initializePieChartButtons(t){const e=document.getElementById("pieChartControls");if(e){e.innerHTML="";const a=t.createChartControls("pieChart",!1);window.ChartButtonIcons.addButtonsToContainer(e,a),this.chartControls.set("pieChart",e)}}initializeBarChartButtons(t){const e=document.getElementById("barChartControls");if(e){e.innerHTML="";const a=t.createChartControls("barChart",!1);window.ChartButtonIcons.addButtonsToContainer(e,a),this.chartControls.set("barChart",e)}}initializeScatterChartButtons(t){const e=document.getElementById("scatterChartControls");if(e){e.innerHTML="";const a=t.createChartControls("scatterChart",!0);window.ChartButtonIcons.addButtonsToContainer(e,a),this.chartControls.set("scatterChart",e)}}reinitializeChartButtons(t,e){const a=`${t}Controls`,r=document.getElementById(a);if(r&&e){r.innerHTML="";const a="scatterChart"===t,o=e.createChartControls(t,a);window.ChartButtonIcons.addButtonsToContainer(r,o)}}updateButtonState(t,e,a){const r=this.chartControls.get(t);if(r){const t=r.querySelector(`.${e}-button`);t&&("loading"===a?window.ChartButtonIcons.addLoadingState(t):"normal"===a&&window.ChartButtonIcons.removeLoadingState(t))}}getButton(t,e){const a=this.chartControls.get(t);return a?a.querySelector(`.${e}-button`):null}addButtonListener(t,e,a){const r=this.getButton(t,e);r&&r.addEventListener("click",a)}removeButtonListener(t,e,a){const r=this.getButton(t,e);r&&r.removeEventListener("click",a)}isInitialized(){return this.initialized}getChartControls(){return this.chartControls}reset(){this.initialized=!1,this.chartControls.clear()}}window.chartButtonsManager=new ChartButtonsManager,"undefined"!=typeof module&&module.exports&&(module.exports=ChartButtonsManager);